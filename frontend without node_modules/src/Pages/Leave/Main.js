import React, { useState } from 'react';
import Table from './Table';
import Apply from './Apply';
import Pending from './Pending';
import { Button, ButtonGroup, Breadcrumb } from 'react-bootstrap';
import { Link } from "react-router-dom";
import RowDetails from './RowDetails';

const Main = () => {
    const [visible, setVisible] = useState("table");
    const [activeButton, setActiveButton] = useState("table");
    const [applications, setApplications] = useState([]);
    const [selectedRow, setSelectedRow] = useState(null);

    const handleSubmit = (application) => {
        const newApplication = { ...application, id: Date.now(), status: "Pending" };
        setApplications([...applications, newApplication]);
        setVisible('table');
    };

    const handleStatusUpdate = (id, newStatus) => {
        setApplications(prevApplications =>
            prevApplications.map(app =>
                app.id === id ? { ...app, status: newStatus } : app
            )
        );
    };

    const handleRowClick = (row) => {
        setSelectedRow(row);
        setVisible('rowDetails');
    };

    const handleButtonClick = (get) => {
        setVisible(get);
        setActiveButton(get);
    };

    return (
        <>

<Breadcrumb className="ms-3">
                <Breadcrumb.Item linkAs={Link} linkProps={{ to: "/hrm" }}>HRM</Breadcrumb.Item>
                <Breadcrumb.Item linkAs={Link} linkProps={{ to: "#" }}>Leave Management</Breadcrumb.Item>
                <Breadcrumb.Item active>Leave Details</Breadcrumb.Item>
            </Breadcrumb>

            <Button variant="primary" className="px-3 " onClick={() => setVisible('form')}>Apply for Leave</Button> <br /><br />

            <div className="w-full">
                <ButtonGroup aria-label="Basic example" className="w-full">
                    <Button variant={activeButton === 'table' ? "primary" : "outline-primary"} className="w-full p-3" onClick={() => handleButtonClick('table')}>Leave Requests</Button>
                    <Button variant={activeButton === 'pendings' ? "primary" : "outline-primary"} className="w-full p-3" onClick={() => handleButtonClick('pendings')}>Pending Leaves</Button>
                </ButtonGroup>

                <div className="relative overflow-x-auto shadow-md sm:rounded-lg">
                    {visible === 'pendings' && <Pending applications={applications} onStatusUpdate={handleStatusUpdate} />}
                    {visible === 'table' && <Table applications={applications} onRowClick={handleRowClick} />}
                    {visible === 'form' && <Apply onSubmit={handleSubmit} />}
                    {visible === 'rowDetails' && <RowDetails row={selectedRow} />}
                </div>
            </div>
        </>
    );
}

export default Main;